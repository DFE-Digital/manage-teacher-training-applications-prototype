{% extends "_layout.njk" %}

{% set primaryNavId = 'overview' %}

{% set title = 'Overview' %}

{% block content %}

  <h1 class="govuk-heading-l"> {{title}} </h1>


  <div class="app-home-statuses govuk-!-margin-bottom-8">

    {# <a href="/notifications/?referrer=overview&type=Application received" class="status-card status-card--pink">
      <span class="status-card__count">3</span>
      <span class="status-card__status">unread notifications about received applications</span>
    </a> #}

    {% if boxes.aboutToBeAutomaticallyRejectedCount > 0 %}
      <a href="/applications/?referrer=overview&importantItem=5 days or fewer to make decision" class="status-card status-card--purple">
        <span class="status-card__count">{{boxes.aboutToBeAutomaticallyRejectedCount}}</span>
        <span class="status-card__status">applications have 5 days or fewer to make a decision</span>
      </a>
    {% endif %}

    {% if boxes.needsFeedbackCount > 0 %}
      <a href="/applications/?referrer=overview&importantItem=Feedback needed" class="status-card status-card--orange">
        <span class="status-card__count">{{boxes.needsFeedbackCount}}</span>
        <span class="status-card__status"> applications need feedback after being automatically rejected</span>
      </a>
    {% endif %}

    {# {% if boxes.deferredOffersReadyToConfirm > 0 %} #}
      <a href="/applications/?referrer=overview&importantItem=Deferred offers ready to confirm" class="status-card status-card--yellow">
        <span class="status-card__count">2</span>
        <span class="status-card__status"> deferred offer ready to be confirmed</span>
      </a>
    {# {% endif %} #}

    {% if boxes.conditionsPending > 0 %}
      <a href="/applications/?referrer=overview&status=Conditions pending&cycle=2020 to 2021" class="status-card status-card--blue">
        <span class="status-card__count">{{boxes.conditionsPending}}</span>
        <span class="status-card__status">offers with conditions pending from the previous recruitment cycle</span>
      </a>
    {% endif %}
  </div>

  {% for organisation in data.user.organisations %}
    <span class="govuk-caption-m">
      {{organisation.name}}
    </span>
    <h3 class="govuk-heading-m">
      Applications waiting for you to make a decision
    </h3>

    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header">Organisation</th>
          <th scope="col" class="govuk-table__header">Number of applications</th>
        </tr>
      </thead>
      <tbody class="govuk-table__body">
        {% if org %}
          <tr class="govuk-table__row">
            <td class="govuk-table__cell">
              <a href="/applications/?referrer=overview&status=Received&status=Interviewing">{{org.name}}</a> (self ratified)
            </td>
            <td class="govuk-table__cell">{{org.apps.length}}</td>
          </tr>
        {% endif %}
        {% for partner in partners %}
          <tr class="govuk-table__row">
            <td class="govuk-table__cell govuk-!-padding-left-">
              <a href="/applications/?referrer=overview&provider={{partner.orgName}}&status=Received&status=Interviewing">{{partner.orgName}}</a>
            </td>
            <td class="govuk-table__cell">{{partner.apps.length}}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endfor %}

   {# <h2 class="govuk-heading-s">
    Partner 2
  </h2> #}

  {# <div class="app-home-statuses govuk-!-margin-bottom-4">

    <a href="/?referrer=overview&assignedUser={{data.user.id}}" class="status-card status-card--grey">
      <span class="status-card__count">15</span>
      <span class="status-card__status">applications in flight to partner 1</span>
    </a>

    <a href="/?referrer=overview&importantItem=`Î© make decision" class="status-card status-card--grey">
      <span class="status-card__count">5</span>
      <span class="status-card__status">applications in flight to partner 2</span>
    </a>

    <a href="/?referrer=overview&importantItem=Feedback needed" class="status-card status-card--grey">
      <span class="status-card__count">3</span>
      <span class="status-card__status">applications in flight to partner 3</span>
    </a>

    <a href="/?referrer=overview&status=Received&status=Interviewing" class="status-card status-card--grey">
      <span class="status-card__count">7</span>
      <span class="status-card__status">applications in flight to partner 4</span>
    </a>

  </div> #}

  {# <h2 class="govuk-heading-m">
    Org 2 that I belong to
  </h2>

  <div class="app-home-statuses govuk-!-margin-bottom-4">

    <a href="/?referrer=overview&assignedUser={{data.user.id}}" class="status-card status-card--grey">
      <span class="status-card__count">15</span>
      <span class="status-card__status">applications in flight to location 1</span>
    </a>

    <a href="/?referrer=overview&importantItem=5 days or fewer to make decision" class="status-card status-card--grey">
      <span class="status-card__count">5</span>
      <span class="status-card__status">applications in flight to location 2</span>
    </a>

    <a href="/?referrer=overview&importantItem=Feedback needed" class="status-card status-card--grey">
      <span class="status-card__count">3</span>
      <span class="status-card__status">applications in flight to location 3</span>
    </a>

    <a href="/?referrer=overview&status=Received&status=Interviewing" class="status-card status-card--grey">
      <span class="status-card__count">7</span>
      <span class="status-card__status">applications in flight to location 4</span>
    </a>

  </div> #}

  {# <h2 class="govuk-heading-m">
    Assigned to you
  </h2> #}

  {# <div class="app-home-statuses govuk-!-margin-bottom-4">

    <a href="/?referrer=overview&assignedUser={{data.user.id}}" class="status-card status-card--grey">
      <span class="status-card__count">15</span>
      <span class="status-card__status">applications assigned to you</span>
    </a>

    <a href="/?referrer=overview&importantItem=5 days or fewer to make decision" class="status-card status-card--red">
      <span class="status-card__count">5</span>
      <span class="status-card__status">applications close to automatic rejection</span>
    </a>

    <a href="/?referrer=overview&importantItem=Feedback needed" class="status-card status-card--orange">
      <span class="status-card__count">3</span>
      <span class="status-card__status">applications need feedback</span>
    </a>

    <a href="/?referrer=overview&status=Received&status=Interviewing" class="status-card status-card--purple">
      <span class="status-card__count">7</span>
      <span class="status-card__status">applications awaiting decision</span>
    </a>

    <a href="/?referrer=overview&status=Deferred" class="status-card status-card--yellow">
      <span class="status-card__count">5</span>
      <span class="status-card__status">deferred offers need to be confirmed</span>
    </a>

    <a href="/?referrer=overview&status=Offered" class="status-card status-card--green">
      <span class="status-card__count">17</span>
      <span class="status-card__status">offers waiting on candidate</span>
    </a>

    <a href="/?referrer=overview&status=Conditions pending" class="status-card status-card--blue">
      <span class="status-card__count">5</span>
      <span class="status-card__status">offers pending conditions (last cycle)</span>
    </a>

    <a href="/?referrer=overview&status=Deferred" class="status-card status-card--yellow">
      <span class="status-card__count">2</span>
      <span class="status-card__status">offers deferred to next cycle</span>
    </a>


  </div> #}

  {# <p><a href="#">View all applications</a></p> #}
{% endblock %}
