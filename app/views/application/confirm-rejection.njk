{% extends "_layout.njk" %}

{% set primaryNavId = 'applications' %}
{% set application = data.applications[applicationId] %}
{% set name = [application["personal-details"]["given-name"], application["personal-details"]["family-name"]] | join(" ") %}
{% set title = "Check and confirm rejection" %}

{% block pageNavigation %}
  {{ govukBackLink({
    href: "/application/" + application.id + "/reject"
  }) }}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <span class="govuk-caption-xl">{{name}}</span>
      <h1 class="govuk-heading-xl">{{title}}</h1>

      {% set candidateActionReasonsHtml %}
        {% set checkboxValue = "Didn’t reply to our interview offer" %}
        {% if checked("candidate-actions-reasons", checkboxValue) %}
          <p>{{checkboxValue}}</p>
        {% endif %}

        {% set checkboxValue = "Didn’t attend interview" %}
        {% if checked("candidate-actions-reasons", checkboxValue) %}
          <p>{{checkboxValue}}</p>
        {% endif %}

        {% set checkboxValue = "Other" %}
        {% if checked("candidate-actions-reasons", "Other") %}
          <p>{{checkboxValue}}: {{data['candidate-actions-reasons-other']}}</p>
        {% endif %}
      {% endset %}

      {% set missingQualificationsReasonsHtml %}
        {% set checkboxValue = "No Maths GCSE grade 4 (C) or above, or valid equivalent" %}
        {% if checked("missing-qualifications-reasons", checkboxValue) %}
          <p>{{checkboxValue}}</p>
        {% endif %}

        {% set checkboxValue = "No English GCSE grade 4 (C) or above, or valid equivalent" %}
        {% if checked("missing-qualifications-reasons", checkboxValue) %}
          <p>{{checkboxValue}}</p>
        {% endif %}

        {% set checkboxValue = "No Science GCSE grade 4 (C) or above, or valid equivalent (for primary applicants)" %}
        {% if checked("missing-qualifications-reasons", checkboxValue) %}
          <p>{{checkboxValue}}</p>
        {% endif %}

        {% set checkboxValue = "No degree" %}
        {% if checked("missing-qualifications-reasons", checkboxValue) %}
          <p>{{checkboxValue}}</p>
        {% endif %}

        {% set checkboxValue = "Degree doesn’t meet course requirements" %}
        {% if checked("missing-qualifications-reasons", checkboxValue) %}
          <p>{{checkboxValue}}</p>
        {% endif %}

        {% set checkboxValue = "Other" %}
        {% if checked("missing-qualifications-reasons", "Other") %}
          <p>{{checkboxValue}}: {{data['candidate-actions-reasons-other']}}</p>
        {% endif %}
      {% endset %}

      {% set applicationQualityReasonsHtml %}
        {% set fieldName = "application-quality-reasons" %}
        {% set checkboxValue = "Personal statement could be improved" %}
        {% set textBoxName = "application-quality-reasons-personal-statement" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>{{checkboxValue}}: {{data[textBoxName]}}</p>
        {% endif %}

        {% set checkboxValue = "Subject knowledge could be improved" %}
        {% set textBoxName = "application-quality-reasons-subject-knowledge" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>{{checkboxValue}}: {{data[textBoxName]}}</p>
        {% endif %}

        {% set checkboxValue = "Other" %}
        {% set textBoxName = "application-quality-reasons-other" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>{{checkboxValue}}: {{data[textBoxName]}}</p>
        {% endif %}
      {% endset %}

      {% set safeguardingReasonsHtml %}
        {% set fieldName = "safeguarding-reasons" %}
        {% set checkboxValue = "Information given on application form false or inaccurate" %}
        {% set textBoxName = "safeguarding-reasons-false-information" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>{{checkboxValue}}: {{data[textBoxName]}}</p>
        {% endif %}

        {% set checkboxValue = "Evidence of plagiarism in personal statement or elsewhere" %}
        {% set textBoxName = "safeguarding-reasons-plagiarism" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>{{checkboxValue}}: {{data[textBoxName]}}</p>
        {% endif %}

        {% set checkboxValue = "References unsatisfactory" %}
        {% set textBoxName = "safeguarding-reasons-references" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>{{checkboxValue}}: {{data[textBoxName]}}</p>
        {% endif %}

        {% set checkboxValue = "Information disclosed by candidate makes them unsuitable to work with children" %}
        {% set textBoxName = "safeguarding-reasons-disclosed-information" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>{{checkboxValue}}: {{data[textBoxName]}}</p>
        {% endif %}

        {% set checkboxValue = "Information revealed by our vetting process makes them unsuitable to work with children" %}
        {% set textBoxName = "safeguarding-reasons-vetting-information" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>{{checkboxValue}}: {{data[textBoxName]}}</p>
        {% endif %}

        {% set checkboxValue = "Other" %}
        {% set textBoxName = "safeguarding-reasons-other" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>{{checkboxValue}}: {{data[textBoxName]}}</p>
        {% endif %}
      {% endset %}

      {% set anotherIssueHtml %}
        {% set fieldName = "another-issue" %}
        <p>{{data[fieldName]}}</p>

        {% set checkboxValue = "Yes" %}
        {% set textBoxName = "another-issue-details" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>Details: {{data[textBoxName]}}</p>
        {% endif %}
      {% endset %}

      {% set otherFeedbackHtml %}
        {% set fieldName = "other-feedback" %}
        <p>{{data[fieldName]}}</p>

        {% set checkboxValue = "Yes" %}
        {% set textBoxName = "other-feedback-details" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>Details: {{data[textBoxName]}}</p>
        {% endif %}
      {% endset %}

      {% set futureApplicationsHtml %}
        {% set fieldName = "future-applications" %}
        <p>{{data[fieldName]}}</p>

        {% set checkboxValue = "Yes" %}
        {% set textBoxName = "future-applications-details" %}
        {% if checked(fieldName, checkboxValue) %}
          <p>Details: {{data[textBoxName]}}</p>
        {% endif %}
      {% endset %}



      {{ govukSummaryList({
        rows: [{
          key: {
            text: "Was it due to candidate actions?"
          },
          value: {
            html: data['candidate-actions']
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        }, {
          key: {
            text: "Candidate action reasons"
          },
          value: {
            html: candidateActionReasonsHtml
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        } if data['candidate-actions'] == "Yes",
        {
          key: {
            text: "Was it because this course is full?"
          },
          value: {
            html: data['course-full']
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        }, {
          key: {
            text: "Was it due to missing qualifications?"
          },
          value: {
            html: data['missing-qualifications']
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        }, {
          key: {
            text: "Missing qualification reasons"
          },
          value: {
            html: missingQualificationsReasonsHtml
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        } if data['missing-qualifications'] == "Yes",
        {
          key: {
            text: "Was it due to the quality of their application?"
          },
          value: {
            html: data['application-quality']
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        }, {
          key: {
            text: "Application quality reasons"
          },
          value: {
            html: applicationQualityReasonsHtml
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        } if data['application-quality'] == "Yes",
        {
          key: {
            text: "Was it related to safeguarding?"
          },
          value: {
            html: data['safeguarding']
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        }, {
          key: {
            text: "Safeguarding reasons"
          },
          value: {
            html: safeguardingReasonsHtml
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        } if data['application-quality'] == "Yes",
        {
          key: {
            text: "Was it related to an issue we haven’t covered here?"
          },
          value: {
            html: anotherIssueHtml
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        },
        {
          key: {
            text: "Is there any other advice or feedback you’d like to give " + name + "?"
          },
          value: {
            html: otherFeedbackHtml
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        },
        {
          key: {
            text: "Would you be interested in future applications from " + name + "?"
          },
          value: {
            html: futureApplicationsHtml
          },
          actions: {
            items: [
              {
                href: "/application/" + application.id + "/reject/",
                text: "Change",
                visuallyHiddenText: ""
              }
            ]
          }
        }
        ]
      }) }}

        {{ govukWarningText({
          text: "The candidate will be told that their application has been rejected and why.",
          iconFallbackText: "Warning"
        }) }}


      <form method="post">
        {{ govukButton({
          text: "Reject application"
        }) }}
      </form>
      <p class="govuk-body"><a href="/application/{{ application.id }}">Cancel</a></p>
    </div>
  </div>
{% endblock %}
