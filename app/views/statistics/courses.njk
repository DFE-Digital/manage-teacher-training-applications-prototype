{% extends "_layout.njk" %}

{% set primaryNavId = "statistics" %}
{% set sectionName = "Applications" %}
{% set pageName = pageName if pageName else "Courses" %}

{% block beforeContent %}
{{ govukBreadcrumbs({
  items: [{
    href: "/statistics",
    text: "Statistics"
  }, {
    text: pageName
  }]
}) }}
{% endblock %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-l">
      <!-- <span class="govuk-caption-l">{{ sectionName }}</span> -->
      {{ pageName }}
    </h1>

    <!-- <p class="govuk-body">
      <a class="govuk-link" href="/statistics/{{ report }}/settings">Change report settings</a>
    </p> -->

    <p class="govuk-body">
      {% if showPercentage and showPercentage == "yes" %}
        <a class="govuk-link govuk-link--no-visited-state" href="/statistics/{{ report }}?showPercentage=no">Hide as percentages of the number of applications received</a>
      {% else %}
        <a class="govuk-link govuk-link--no-visited-state" href="/statistics/{{ report }}?showPercentage=yes">Show as percentages of the number of applications received</a>
      {% endif %}
    </p>

  </div>
</div>

{% if data.statisticsOptions %}

<div class="app-filter-layout">
  <div class="app-filter-layout__filter">

    {% include "_includes/statistics/selected-config.njk" %}

    {% include "_includes/statistics/filter-panel.njk" %}

  </div>
  <div class="app-filter-layout__content">

    <div class="app-action-bar">
      <div class="app-action-bar__filter"></div>
    </div>

    <div>

      {% include "_includes/statistics/table.njk" %}

    </div>
  </div>
</div>

{% else %}

  {% include "_includes/statistics/table.njk" %}

{% endif %}

{% endblock %}

{% block pageScripts %}
  {% if data.statisticsOptions %}
    <script src="/public/javascripts/components/filter-toggle-button/filter-toggle-button.js"></script>
    <script>
      new AppFrontend.FilterToggleButton({
        bigModeMediaQuery: '(min-width: 48.063em)',
        startHidden: false,
        toggleButton: {
          container: $('.app-action-bar__filter'),
          showText: 'Show filter',
          hideText: 'Hide filter',
          classes: 'govuk-button--secondary govuk-!-margin-bottom-3'
        },
        closeButton: {
          container: $('.app-filter__header-action'),
          text: 'Close'
        },
        filter: {
          container: $('.app-filter-layout__filter')
        }
      })
    </script>

    {% if subjectItems.length >= subjectItemsDisplayLimit %}
      <script type="text/javascript" src="/public/javascripts/components/checkbox-filter/checkbox-filter.js"></script>
      <script type="text/javascript">
        new AppFrontend.CheckboxFilter({
          container: $('#subject'),
          textBox: {
            label: 'Search for subject'
          }
        })
      </script>
    {% endif %}
  {% endif %}
{% endblock %}
