{% extends "_layout.njk" %}

{% set primaryNavId = "statistics" %}
{% set pageName = "Configure report" %}

{% block beforeContent %}
{{ govukBackLink({
  text: "Back",
  href: "/statistics/" + section + "/" + report
}) }}
{% endblock %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-l">
      <span class="govuk-caption-l">
        {{ reportName }}
      </span>
      {{ pageName }}
    </h1>

    {% include "_includes/statistics/selected-config-options.njk" %}

    <form action="/statistics/{{ section }}/{{ report }}" method="post" accept-charset="UTF-8" novalidate>

      {{ govukCheckboxes({
        idPrefix: "cycle",
        name: "statisticsOptions[cycle]",
        fieldset: {
          legend: {
            text: "Year received",
            isPageHeading: false,
            classes: "govuk-fieldset__legend--s"
          }
        },
        items: [
          {
            value: "2020 to 2021",
            text: "2020 to 2021" | cycleText,
            checked: checked(data.statisticsOptions.cycle, "2020 to 2021")
          },
          {
            value: "2019 to 2020",
            text: "2019 to 2020" | cycleText,
            checked: checked(data.statisticsOptions.cycle, "2019 to 2020")
          }
        ]
      }) if 'cycle' in configOptions }}

      {{ govukCheckboxes({
        idPrefix: "status",
        name: "statisticsOptions[status]",
        fieldset: {
          legend: {
            text: "Status",
            classes: "govuk-fieldset__legend--s"
          }
        },
        items: [
          {
            value: "Received",
            text: "Received",
            checked: checked(data.statisticsOptions.status, "Received") == "checked"
          },
          {
            value: "Interviewing",
            text: "Interviewing",
            checked: checked(data.statisticsOptions.status, "Interviewing") == "checked"
          },
          {
            value: "Offered",
            text: "Offered",
            checked: checked(data.statisticsOptions.status, "Offered") == "checked"
          },
          {
            value: "Awaiting conditions",
            text: "Awaiting conditions",
            checked: checked(data.statisticsOptions.status, "Awaiting conditions") == "checked"
          },
          {
            value: "Ready to enroll",
            text: "Ready to enroll",
            checked: checked(data.statisticsOptions.status, "Ready to enroll") == "checked"
          },
           {
            value: "Conditions not met",
            text: "Conditions not met",
            checked: checked(data.statisticsOptions.status, "Conditions not met") == "checked"
          },
          {
            value: "Deferred",
            text: "Deferred",
            checked: checked(data.statisticsOptions.status, "Deferred") == "checked"
          },
          {
            value: "Declined",
            text: "Declined",
            checked: checked(data.statisticsOptions.status, "Declined") == "checked"
          },
          {
            value: "Rejected",
            text: "Rejected",
            checked: checked(data.statisticsOptions.status, "Rejected") == "checked"
          },
          {
            value: "Application withdrawn",
            text: "Application withdrawn",
            checked: checked(data.statisticsOptions.status, "Application withdrawn") == "checked"
          },
          {
            value: "Offer withdrawn",
            text: "Offer withdrawn",
            checked: checked(data.statisticsOptions.status, "Offer withdrawn") == "checked"
          }
        ]
      })  if 'status' in configOptions }}

      {{ govukCheckboxes({
        idPrefix: "provider",
        name: "statisticsOptions[provider]",
        fieldset: {
          legend: {
            text: "Courses run by",
            classes: "govuk-fieldset__legend--s"
          }
        },
        items: [
          {
            value: data.user.organisations[0].name,
            text: data.user.organisations[0].name,
            checked: checked(data.statisticsOptions.provider, data.user.organisations[0].name) == "checked"
          },
          {
            value: data.user.organisations[1].name,
            text: data.user.organisations[1].name,
            checked: checked(data.statisticsOptions.provider, data.user.organisations[1].name) == "checked"
          }
        ]
      }) if 'trainingProvider' in configOptions }}

      {#% if checked(data.statisticsOptions.provider, data.user.organisations[0].name) %#}

        {{ govukCheckboxes({
          name: "statisticsOptions[location]",
          fieldset: {
            legend: {
              text: "Training locations",
              classes: "govuk-fieldset__legend--s"
            }
          },
          items: [
            {
              value: "Main site",
              text: "Main site",
              checked: checked(data.statisticsOptions.location, "Main site") == "checked"
            },
            {
              value: "Camberley - training location",
              text: "Camberley - training location",
              checked: checked(data.statisticsOptions.location, "Camberley - training location") == "checked"
            },
            {
              value: "Epsom Grinstead - training location",
              text: "Epsom Grinstead - training location",
              checked: checked(data.statisticsOptions.location, "Epsom Grinstead - training location") == "checked"
            },
            {
              value: "Lingfield - training location",
              text: "Lingfield - training location",
              checked: checked(data.statisticsOptions.location, "Lingfield - training location") == "checked"
            }
          ]
        }) if 'location' in configOptions }}

      {#% endif %#}

      {{ govukCheckboxes({
        idPrefix: "accreditedBody",
        name: "statisticsOptions[accreditedBody]",
        fieldset: {
          legend: {
            text: "Courses ratified by",
            classes: "govuk-fieldset__legend--s"
          }
        },
        items: [
          {
            value: data.accreditedBodies[0].name,
            text: data.accreditedBodies[0].name,
            checked: checked(data.statisticsOptions.accreditedBody, data.accreditedBodies[0].name) == "checked"
          },
          {
            value: data.accreditedBodies[1].name,
            text: data.accreditedBodies[1].name,
            checked: checked(data.statisticsOptions.accreditedBody, data.accreditedBodies[1].name) == "checked"
          }
        ]
      }) if 'accreditedBody' in configOptions }}

      {#% if subjectItems.length >= subjectItemsDisplayLimit %}

        {{ appCheckboxFilter({
          idPrefix: "subject",
          name: "statisticsOptions[subject]",
          legend: {
            text: "Subject"
          },
          items: subjectItems,
          selectedItems: selectedSubjects,
          classes: "govuk-!-margin-bottom-7"
        }) }}

      {% else %}

        {{ govukCheckboxes({
          idPrefix: "subject",
          name: "statisticsOptions[subject]",
          fieldset: {
            legend: {
              text: "Subject",
              classes: "govuk-fieldset__legend--s"
            }
          },
          items: subjectItems,
          classes: "govuk-checkboxes--small"
        }) }}

      {% endif %#}

      {{ govukCheckboxes({
        idPrefix: "studyMode",
        name: "statisticsOptions[studyMode]",
        fieldset: {
          legend: {
            text: "Full time or part time",
            classes: "govuk-fieldset__legend--s"
          }
        },
        items: [
          {
            value: "Full time",
            text: "Full time",
            checked: checked(data.statisticsOptions.studyMode, "Full time") == "checked"
          },
          {
            value: "Part time",
            text: "Part time",
            checked: checked(data.statisticsOptions.studyMode, "Part time") == "checked"
          }
        ]
      }) if 'studyMode' in configOptions }}

      {{ govukCheckboxes({
        idPrefix: "fundingType",
        name: "statisticsOptions[fundingType]",
        fieldset: {
          legend: {
            text: "Funding type",
            classes: "govuk-fieldset__legend--s"
          }
        },
        items: [
          {
            value: "Fee paying",
            text: "Fee paying",
            checked: checked(data.statisticsOptions.fundingType, "Fee paying") == "checked"
          },
          {
            value: "Salaried",
            text: "Salaried",
            checked: checked(data.statisticsOptions.fundingType, "Salaried") == "checked"
          },
          {
            value: "Apprenticeship",
            text: "Apprenticeship",
            checked: checked(data.statisticsOptions.fundingType, "Apprenticeship") == "checked"
          }
        ]
      })  if 'fundingType' in configOptions }}

      {{ govukCheckboxes({
        idPrefix: "subjectLevel",
        name: "statisticsOptions[subjectLevel]",
        fieldset: {
          legend: {
            text: "Subject level",
            classes: "govuk-fieldset__legend--s"
          }
        },
        items: [
          {
            value: "Primary",
            text: "Primary",
            checked: checked(data.statisticsOptions.subjectLevel, "Primary") == "checked"
          },
          {
            value: "Secondary",
            text: "Secondary",
            checked: checked(data.statisticsOptions.subjectLevel, "Secondary") == "checked"
          }
        ]
      }) if 'subjectLevel' in configOptions }}

      {{ govukButton({
        text: "Save settings and view report"
      }) }}

    </form>

  </div>
  <div class="govuk-grid-column-one-third">

  </div>
</div>

{% endblock %}
