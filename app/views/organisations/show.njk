{% extends "_layout.njk" %}

{% set primaryNavId = 'organisations' %}
{% set trainingProvider = org.name %}
{% set title = trainingProvider %}

{% block content %}

  {{ appBanner({
    html: "<h2 class=\"govuk-heading-m\">"+flashMessage+"</h2>",
    type: "success",
    icon: false
  }) if flashMessage }}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-xl">{{title}}</h1>

      {% set tick %}
        {{ appIcon({
          classes: "govuk-!-margin-right-1",
          icon: "tick",
          hidden: true
        }) }}
      {% endset %}

      {% for partner in org.partners %}
        <h2 class="govuk-heading-m">

          {% if org.isAccreditedBody %}
            For courses ratified by {{ org.name }} and run by {{ partner.name }}
          {% else %}
            For courses run by {{ org.name }} and ratified by {{ partner.name }}
          {% endif %}
        </h2>

        {% if org.isAccreditedBody %}
          {% if not org.permissions %}
            {% set bannerHtml %}
              <p>{{ trainingProvider }} have not set up permissions yet – only they can set up permissions. Contact them to do this.</p>
              <p>Staff at {{ data.accreditedBodies[0].name}} can still view applications in the mean time.</p>
            {% endset %}
            {{appBanner({
              html: bannerHtml
            })}}
          {% else %}
            {{appBanner({
              text: "Contact " + data.organisations[2].name + " to change permissions.",
              classes: "govuk-!-margin-bottom-4"
            })}}
          {% endif %}
        {% endif %}

        <p>The following organisation(s) can make decisions:</p>

        <ul class="govuk-list">
          {% if org.permissions.makeDecisions %}
            <li>{{tick | safe }} {{ org.name }}</li>
          {% endif %}
          {% if partner.permissions.makeDecisions %}
            <li>{{tick | safe }} {{ partner.name }}</li>
          {% endif %}
        </ul>

        <p>The following organisation(s) can view safeguarding information:</p>

        <ul class="govuk-list">
          {% if org.permissions.safeguarding %}
            <li>{{tick | safe }} {{ org.name }}</li>
          {% endif %}
          {% if partner.permissions.safeguarding %}
            <li>{{tick | safe }} {{ partner.name }}</li>
          {% endif %}
        </ul>

        <p>The following organisation(s) can view diversity information:</p>

        <ul class="govuk-list">
          {% if org.permissions.diversity %}
            <li>{{tick | safe }} {{ org.name }}</li>
          {% endif %}
          {% if partner.permissions.diversity %}
            <li>{{tick | safe }} {{ partner.name }}</li>
          {% endif %}
        </ul>

        <p><a href="/organisations/{{org.id}}/edit">Change <span class="govuk-visually-hidden">permissions for {{ org.name}}</span></a></p>

      {% endfor %}

      {# <h2 class="govuk-heading-m">
        For courses ratified by {{ data.accreditedBodies[0].name }} and run by {{ trainingProvider }}
      </h2>

      {% set bannerHtml %}
        <p>{{ trainingProvider }} have not set up permissions yet – only they can set up permissions. Contact them to do this.</p>
        <p>Staff at {{ data.accreditedBodies[0].name}} can still view applications in the mean time.</p>
      {% endset %}
      {{appBanner({
        html: bannerHtml
      })}}

      <h2 class="govuk-heading-m">
      For courses ratified by {{ data.accreditedBodies[0].name }} and run by {{ data.organisations[2].name }}
      </h2>

      {{appBanner({
        text: "Contact " + data.organisations[2].name + " to change permissions.",
        classes: "govuk-!-margin-bottom-4"
      })}}

      <p>The following organisation(s) can make decisions:</p>

      <ul class="govuk-list">
        <li>{{tick | safe }} {{ data.accreditedBodies[0].name }}</li>
      </ul>

      <p>The following organisation(s) can view safeguarding information:</p>

      <ul class="govuk-list">
        <li>{{tick | safe }} {{ data.organisations[2].name }}</li>
      </ul>

      <p>The following organisation(s) can view diversity information:</p>

      <ul class="govuk-list">
        <li>{{tick | safe }} {{ data.organisations[2].name }}</li>
      </ul>

      <h2 class="govuk-heading-m">
      For courses ratified by {{ data.accreditedBodies[0].name }} and run by {{ data.organisations[3].name }}
      </h2>

      {{appBanner({
        text: "Contact " + data.organisations[3].name + " to change permissions.",
        classes: "govuk-!-margin-bottom-4"
      })}}

      <p>The following organisation(s) can make decisions:</p>

      <ul class="govuk-list">
        <li>{{tick | safe }} {{ data.accreditedBodies[0].name }}</li>
      </ul>

      <p>The following organisation(s) can view safeguarding information:</p>

      <ul class="govuk-list">
        <li>{{tick | safe }} {{ data.organisations[3].name }}</li>
      </ul>

      <p>The following organisation(s) can view diversity information:</p>

      <ul class="govuk-list">
        <li>{{tick | safe }} {{ data.organisations[3].name }}</li>
      </ul>

      <h2 class="govuk-heading-m">
      For courses ratified by {{ data.accreditedBodies[0].name }} and run by {{ data.organisations[4].name }}
      </h2>

      <p>The following organisation(s) can make decisions:</p>

      <ul class="govuk-list">
        <li>{{tick | safe }} {{ data.accreditedBodies[0].name }}</li>
      </ul>

      <p>The following organisation(s) can view safeguarding information:</p>

      <ul class="govuk-list">
        <li>{{tick | safe }} {{ data.organisations[4].name }} </li>
      </ul>

      <p>The following organisation(s) can view diversity information:</p>

      <ul class="govuk-list">
        <li>{{tick | safe }} {{ data.organisations[4].name }} </li>
      </ul>

      <p>You can also <a href="/organisations/show3">manage permissions for {{ data.organisations[4].name }}</a>.</p> #}

    </div>
  </div>

{% endblock %}
